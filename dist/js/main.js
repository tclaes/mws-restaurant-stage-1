let restaurants,neighborhoods,cuisines;var markers=[];document.addEventListener('DOMContentLoaded',()=>{fetchNeighborhoods(),fetchCuisines()}),lazyLoad=()=>new LazyLoad,fetchNeighborhoods=()=>{DBHelper.fetchNeighborhoods((a,b)=>{a?console.error(a):(self.neighborhoods=b,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=(a=self.neighborhoods)=>{const b=document.getElementById('neighborhoods-select');a.forEach((a)=>{const c=document.createElement('option');c.innerHTML=a,c.value=a,b.append(c)})},fetchCuisines=()=>{DBHelper.fetchCuisines((a,b)=>{a?console.error(a):(self.cuisines=b,fillCuisinesHTML())})},fillCuisinesHTML=(a=self.cuisines)=>{const b=document.getElementById('cuisines-select');a.forEach((a)=>{const c=document.createElement('option');c.innerHTML=a,c.value=a,b.append(c)})},window.initMap=()=>{self.map=new google.maps.Map(document.getElementById('map'),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),self.map.addListener('tilesloaded',setMapTitle),updateRestaurants()},setMapTitle=()=>{const a=document.querySelector('#map').querySelector('iframe');a.setAttribute('title','Google maps with restaurant location')},updateRestaurants=()=>{const a=document.getElementById('cuisines-select'),b=document.getElementById('neighborhoods-select'),c=a.selectedIndex,d=b.selectedIndex,e=a[c].value,f=b[d].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(e,f,(a,b)=>{a?console.error(a):(resetRestaurants(b),fillRestaurantsHTML())})},resetRestaurants=(a)=>{self.restaurants=[];const b=document.getElementById('restaurants-list');b.innerHTML='',self.markers.forEach((a)=>a.setMap(null)),self.markers=[],self.restaurants=a},fillRestaurantsHTML=(a=self.restaurants)=>{const b=document.getElementById('restaurants-list');a.forEach((a)=>{DBHelper.saveRestaurantDataLocally(a),b.append(createRestaurantHTML(a))}),addMarkersToMap()},createRestaurantHTML=(a)=>{const b=document.createElement('li'),c=document.createElement('picture'),d=document.createElement('source');d.className='restaurant-img lazy',d.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_small.webp'),d.setAttribute('media','(min-width: 400px)'),c.append(d);const e=document.createElement('source');e.className='restaurant-img lazy',e.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_large.webp'),e.setAttribute('media','(min-width: 900px)'),c.append(e);const f=document.createElement('img');f.className='restaurant-img lazy',f.setAttribute('data-src',DBHelper.imageUrlForRestaurant(a)+'_small.jpg'),f.alt='An image of restaurant '+a.name+' in '+a.neighborhood,c.append(f),b.append(c);const g=document.createElement('h2');g.innerHTML=a.name,b.append(g);const h=document.createElement('p');h.innerHTML=a.neighborhood,b.append(h);const i=document.createElement('p');i.innerHTML=a.address,b.append(i);const j=document.createElement('a');return j.innerHTML='View Details',j.href=DBHelper.urlForRestaurant(a),b.append(j),b.onload=lazyLoad(),b},addMarkersToMap=(a=self.restaurants)=>{a.forEach((a)=>{const b=DBHelper.mapMarkerForRestaurant(a,self.map);google.maps.event.addListener(b,'click',()=>{window.location.href=b.url}),self.markers.push(b)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJmZXRjaEN1aXNpbmVzIiwiY29uc29sZSIsImVycm9yIiwic2VsZiIsIm5laWdoYm9yaG9vZHMiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJkb2N1bWVudCIsImZvckVhY2giLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwidmFsdWUiLCJzZWxlY3QiLCJhcHBlbmQiLCJEQkhlbHBlciIsImN1aXNpbmVzIiwiZmlsbEN1aXNpbmVzSFRNTCIsImdldEVsZW1lbnRCeUlkIiwiY3Vpc2luZSIsIndpbmRvdyIsImluaXRNYXAiLCJsb2MiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsInNjcm9sbHdoZWVsIiwibGF0IiwibG5nIiwiYWRkTGlzdGVuZXIiLCJzZXRNYXBUaXRsZSIsInVwZGF0ZVJlc3RhdXJhbnRzIiwibWFwRnJhbWUiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtYXJrZXJzIiwic2F2ZVJlc3RhdXJhbnREYXRhTG9jYWxseSIsInVsIiwiYWRkTWFya2Vyc1RvTWFwIiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJzb3VyY2VTbWFsbCIsImNsYXNzTmFtZSIsInNvdXJjZUxhcmdlIiwiaW1hZ2UiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJyZXN0YXVyYW50IiwiYWx0IiwibmFtZSIsImFkZHJlc3MiLCJtb3JlIiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQSxBQUFJQSxhQUFKLEFBR0Es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QSxBQUNBLFlBQUEsQUFBTThELEtBQU4sQUFBTUEsTUFBTixBQUFlOUMsQUFBUytDLGNBQXhCLEFBQXdCQSxRQUF1Qk4sSUFBQUEsQUFDL0NoQyxRQUFBQSxBQUFPQyxTQUFQRCxBQUFrQlEsS0FBQUEsRUFBbEJSLEFBQThCcUMsQUFDNUJ6QyxHQUZGLEFBR0MsUUFBQSxBQUZELFFBRUMsQUFGRCxBQUdBakIsT0FQSjhDLEFBUUcsRUFSSCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXM7XHJcbnZhciBtYXJrZXJzID0gW107XHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogTGF6eUxvYWRpbmcgaW1hZ2VzIG9uIGluaXRcclxuICovXHJcblxyXG5sYXp5TG9hZCA9ICgpID0+IG5ldyBMYXp5TG9hZCAoKTtcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XHJcbiAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIG5laWdoYm9yaG9vZHMuZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cclxuICovXHJcbmZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG5cclxuICBjdWlzaW5lcy5mb3JFYWNoKGN1aXNpbmUgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcclxuICAgIG9wdGlvbi52YWx1ZSA9IGN1aXNpbmU7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfTtcclxuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICB6b29tOiAxMixcclxuICAgIGNlbnRlcjogbG9jLFxyXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgfSk7XHJcbiAgc2VsZi5tYXAuYWRkTGlzdGVuZXIoJ3RpbGVzbG9hZGVkJywgc2V0TWFwVGl0bGUpO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn07XHJcblxyXG5zZXRNYXBUaXRsZSA9ICgpID0+IHtcclxuICAgIGNvbnN0IG1hcEZyYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21hcCcpLnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpO1xyXG4gICAgbWFwRnJhbWUuc2V0QXR0cmlidXRlKCd0aXRsZScsICdHb29nbGUgbWFwcyB3aXRoIHJlc3RhdXJhbnQgbG9jYXRpb24nKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAgIERCSGVscGVyLnNhdmVSZXN0YXVyYW50RGF0YUxvY2FsbHkocmVzdGF1cmFudCk7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xyXG4gIH0pO1xyXG4gIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG5cclxuICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncGljdHVyZScpO1xyXG5cclxuICBjb25zdCBzb3VyY2VTbWFsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gIHNvdXJjZVNtYWxsLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyBsYXp5JztcclxuICBzb3VyY2VTbWFsbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNyY3NldFwiLERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArIFwiX3NtYWxsLndlYnBcIik7XHJcbiAgc291cmNlU21hbGwuc2V0QXR0cmlidXRlKFwibWVkaWFcIiwgXCIobWluLXdpZHRoOiA0MDBweClcIilcclxuICBwaWN0dXJlLmFwcGVuZChzb3VyY2VTbWFsbCk7XHJcblxyXG4gICAgY29uc3Qgc291cmNlTGFyZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZUxhcmdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyBsYXp5JztcclxuICAgIHNvdXJjZUxhcmdlLnNldEF0dHJpYnV0ZShcImRhdGEtc3Jjc2V0XCIsREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpICsgXCJfbGFyZ2Uud2VicFwiKTtcclxuICAgIHNvdXJjZUxhcmdlLnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIFwiKG1pbi13aWR0aDogOTAwcHgpXCIpXHJcbiAgICBwaWN0dXJlLmFwcGVuZChzb3VyY2VMYXJnZSk7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nIGxhenknO1xyXG4gIGltYWdlLnNldEF0dHJpYnV0ZShcImRhdGEtc3JjXCIsIERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArIFwiX3NtYWxsLmpwZ1wiKTtcclxuICBpbWFnZS5hbHQgPSBcIkFuIGltYWdlIG9mIHJlc3RhdXJhbnQgXCIgKyByZXN0YXVyYW50Lm5hbWUgKyBcIiBpbiBcIiArIHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgbGkuYXBwZW5kKHBpY3R1cmUpO1xyXG5cclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBsaS5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBsaS5hcHBlbmQobW9yZSk7XHJcblxyXG4gIGxpLm9ubG9hZCA9IGxhenlMb2FkKCk7XHJcblxyXG4gIHJldHVybiBsaVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn07XHJcbiJdfQ==
