'use strict';var restaurant,map;lazyLoad=function(){return new LazyLoad},window.initMap=function(){fetchRestaurantFromURL(function(a,b){a?console.error(a):(self.map=new google.maps.Map(document.getElementById('map'),{zoom:16,center:b.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},fetchRestaurantFromURL=function(a){if(self.restaurant)return void a(null,self.restaurant);var b=getParameterByName('id');b?DBHelper.fetchRestaurantById(b,function(b,c){return self.restaurant=c,c?void(fillRestaurantHTML(),a(null,c)):void console.error(b)}):(error='No restaurant id in URL',a(error,null))},fillRestaurantHTML=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant,b=document.getElementById('restaurant-name');b.innerHTML=a.name;var c=document.getElementById('restaurant-address');c.innerHTML=a.address;var d=document.getElementById('restaurant-img'),e=document.createElement('source');e.className='restaurant-img',e.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_small.webp'),e.setAttribute('media','(min-width: 400px)'),d.append(e);var f=document.createElement('source');f.className='restaurant-img',f.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_large.webp'),f.setAttribute('media','(min-width: 900px)'),d.append(f);var g=document.createElement('img');g.className='restaurant-img lazy',g.setAttribute('data-src',DBHelper.imageUrlForRestaurant(a)+'_small.jpg'),g.alt='An image of restaurant '+a.name+' in '+a.neighborhood,d.append(g),d.onload=lazyLoad();var h=document.getElementById('restaurant-cuisine');h.innerHTML=a.cuisine_type,a.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant.operating_hours,b=document.getElementById('restaurant-hours');for(var c in a){var d=document.createElement('tr'),e=document.createElement('td');e.innerHTML=c,d.appendChild(e);var f=document.createElement('td');f.innerHTML=a[c],d.appendChild(f),b.appendChild(d)}},fillReviewsHTML=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,b=document.getElementById('reviews-container'),c=document.createElement('h3');if(c.innerHTML='Reviews',b.appendChild(c),!a){var d=document.createElement('p');return d.innerHTML='No reviews yet!',void b.appendChild(d)}var e=document.getElementById('reviews-list');a.forEach(function(a){e.appendChild(createReviewHTML(a))}),b.appendChild(e)},createReviewHTML=function(a){var b=document.createElement('li'),c=document.createElement('p');c.innerHTML=a.name,b.appendChild(c);var d=document.createElement('p');d.innerHTML=a.date,b.appendChild(d);var e=document.createElement('p');e.innerHTML='Rating: '+a.rating,b.appendChild(e);var f=document.createElement('p');return f.innerHTML=a.comments,b.appendChild(f),b},fillBreadcrumb=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant,b=document.getElementById('breadcrumb'),c=document.createElement('li');c.innerHTML=a.name,b.appendChild(c)},getParameterByName=function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,'\\$&');var c=new RegExp('[?&]'+a+'(=([^&#]*)|&|#|$)'),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g,' ')):'':null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJsYXp5TG9hZCIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJyZXN0YXVyYW50IiwiY29uc29sZSIsInNlbGYiLCJ6b29tIiwiY2VudGVyIiwic2Nyb2xsd2hlZWwiLCJEQkhlbHBlciIsImlkIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImNhbGxiYWNrIiwiZmlsbFJlc3RhdXJhbnRIVE1MIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm5hbWUiLCJhZGRyZXNzIiwic291cmNlU21hbGwiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic2V0QXR0cmlidXRlIiwicGljdHVyZSIsImFwcGVuZCIsInNvdXJjZUxhcmdlIiwiaW1hZ2UiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiZGF5IiwidGltZSIsInJvdyIsImFwcGVuZENoaWxkIiwiaG91cnMiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJpbm5lckhUTUwiLCJub1Jldmlld3MiLCJ1bCIsImxpIiwicmF0aW5nIiwicmV2aWV3IiwiY29tbWVudHMiLCJmaWxsQnJlYWRjcnVtYiIsImJyZWFkY3J1bWIiXSwibWFwcGluZ3MiOiJhQUFBLEdBQUEsQUFBSSxBQUNKLFlBQUEsQUFBSSxBQUFKLElBTUEsU0FBVyxVQUFBLE9BQU0sSUFBTixBQUFNLEFBQUksU0FBckIsQUFBQUEsRUFLQSxPQUFBLEFBQU8sUUFBVSxVQUFNLEFBSHZCLHdCQUFBLGFBQUEsQUFLSSxBQUFJLEFBQU8sQUFBRSxBQUNYLFdBREYsQUFDRSxBQUFRLEFBQU0sQUFIcEJDLEFBQU9DLEFBQ0xDLGVBQUFBLElBQUFBLEdBQUFBLFFBQUFBLEFBQXVCLEtBQXZCQSxBQUF1QixJQUFDQyxTQUFBQSxBQUFPQyxl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QTlCLEFBQ0FGLFdBQUdSLEVBQVlTLFNBQUFBLEFBQWYsZUFBQUQsQUFBZUMsQUFBZixBQWNBLGNBQU0sRUFBSyxTQUFBLEFBQVMsY0FBcEIsQUFBVyxBQUF1QixBQVpsQyxRQUFBLFVBQWlCM0IsRUFBakIsQUFBMEJLLEFBQzFCd0IsT0FBQUEsQUFBU04sQUFBWUssQUFDckJGLGNBTEFDLEFBT0EsRUFHRixtQkFBQSxhQUFBLEFBY0UsQUFBSSxBQUFDLEtBQ0gsRUFBTSxPQUFBLEFBQU8sU0FBYixBQUFzQixBQVoxQkcsUUFBQUEsRUFBQUEsUUFBQUEsQUFBaUIsVUFBakJBLEFBQWlCLEFBQWdDLFdBQS9CMUMsR0FBK0IsR0FBQSxRQUFBLFNBQUEscUJBZTdDLEVBQVUsRUFmbUMsQUFlbkMsQUFBTSxBQUFLLEFBZHZCLEFBQU0yQyxBQUNOLGlCQUNHUixFQUFIRyxBQUFHSCxBQUFILEFBQ0FRLEdBSkYsbUJBQUEsRUFBQSxHQUFBLFFBQUEsTUFBQSxBQXFCQyxNQWpCQ0EsQUFKRixHQUVFLEFBQVcvQixBQUNYMEIsQUFBR0gsSUFOTCIsImZpbGUiOiJyZXN0YXVyYW50X2luZm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcclxudmFyIG1hcDtcclxuXHJcbi8qKlxyXG4gKiBMYXp5TG9hZGluZyBpbWFnZXMgb24gaW5pdFxyXG4gKi9cclxuXHJcbmxhenlMb2FkID0gKCkgPT4gbmV3IExhenlMb2FkICgpO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcclxuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJztcclxuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICB9IGVsc2Uge1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XHJcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKTtcclxuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuXHJcbiAgICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XHJcblxyXG4gICAgY29uc3Qgc291cmNlU21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZVNtYWxsLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBzb3VyY2VTbWFsbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNyY3NldFwiLERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArIFwiX3NtYWxsLndlYnBcIik7XHJcbiAgICBzb3VyY2VTbWFsbC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBcIihtaW4td2lkdGg6IDQwMHB4KVwiKVxyXG4gICAgcGljdHVyZS5hcHBlbmQoc291cmNlU21hbGwpO1xyXG5cclxuICAgIGNvbnN0IHNvdXJjZUxhcmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgICBzb3VyY2VMYXJnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gICAgc291cmNlTGFyZ2Uuc2V0QXR0cmlidXRlKFwiZGF0YS1zcmNzZXRcIixEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyBcIl9sYXJnZS53ZWJwXCIpO1xyXG4gICAgc291cmNlTGFyZ2Uuc2V0QXR0cmlidXRlKFwibWVkaWFcIiwgXCIobWluLXdpZHRoOiA5MDBweClcIilcclxuICAgIHBpY3R1cmUuYXBwZW5kKHNvdXJjZUxhcmdlKTtcclxuXHJcbiAgICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nIGxhenknO1xyXG4gICAgaW1hZ2Uuc2V0QXR0cmlidXRlKFwiZGF0YS1zcmNcIiwgREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpICsgXCJfc21hbGwuanBnXCIpO1xyXG4gICAgaW1hZ2UuYWx0ID0gXCJBbiBpbWFnZSBvZiByZXN0YXVyYW50IFwiICsgcmVzdGF1cmFudC5uYW1lICsgXCIgaW4gXCIgKyByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICAgIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgICBwaWN0dXJlLm9ubG9hZCA9IGxhenlMb2FkKCk7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XHJcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcclxuXHJcbiAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcclxuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcclxuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XHJcbiAgfVxyXG4gIC8vIGZpbGwgcmV2aWV3c1xyXG4gIGZpbGxSZXZpZXdzSFRNTCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcclxuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XHJcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XHJcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xyXG5cclxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xyXG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XHJcblxyXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSk7XHJcblxyXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xyXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuXHJcbiAgaWYgKCFyZXZpZXdzKSB7XHJcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XHJcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xyXG4gIH0pO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcclxuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xyXG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xyXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XHJcblxyXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gIHJldHVybiBsaTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxyXG4gKi9cclxuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKTtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XHJcbiAgaWYgKCF1cmwpXHJcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XHJcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXHJcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xyXG4gIGlmICghcmVzdWx0cylcclxuICAgIHJldHVybiBudWxsO1xyXG4gIGlmICghcmVzdWx0c1syXSlcclxuICAgIHJldHVybiAnJztcclxuICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xyXG59XHJcbiJdfQ==
