let restaurant;var map;lazyLoad=()=>new LazyLoad,window.initMap=()=>{fetchRestaurantFromURL((a,b)=>{a?console.error(a):(self.map=new google.maps.Map(document.getElementById('map'),{zoom:16,center:b.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},fetchRestaurantFromURL=(a)=>{if(self.restaurant)return void a(null,self.restaurant);const b=getParameterByName('id');b?DBHelper.fetchRestaurantById(b,(b,c)=>(self.restaurant=c,c?void(fillRestaurantHTML(),a(null,c)):void console.error(b))):(error='No restaurant id in URL',a(error,null))},fillRestaurantHTML=(a=self.restaurant)=>{const b=document.getElementById('restaurant-name');b.innerHTML=a.name;const c=document.getElementById('restaurant-address');c.innerHTML=a.address;const d=document.getElementById('restaurant-img'),e=document.createElement('source');e.className='restaurant-img',e.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_small.webp'),e.setAttribute('media','(min-width: 400px)'),d.append(e);const f=document.createElement('source');f.className='restaurant-img',f.setAttribute('data-srcset',DBHelper.imageUrlForRestaurant(a)+'_large.webp'),f.setAttribute('media','(min-width: 900px)'),d.append(f);const g=document.createElement('img');g.className='restaurant-img lazy',g.setAttribute('data-src',DBHelper.imageUrlForRestaurant(a)+'_small.jpg'),g.alt='An image of restaurant '+a.name+' in '+a.neighborhood,d.append(g),d.onload=lazyLoad();const h=document.getElementById('restaurant-cuisine');h.innerHTML=a.cuisine_type,a.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=(a=self.restaurant.operating_hours)=>{const b=document.getElementById('restaurant-hours');for(let c in a){const d=document.createElement('tr'),e=document.createElement('td');e.innerHTML=c,d.appendChild(e);const f=document.createElement('td');f.innerHTML=a[c],d.appendChild(f),b.appendChild(d)}},fillReviewsHTML=(a=self.restaurant.reviews)=>{const b=document.getElementById('reviews-container'),c=document.createElement('h3');if(c.innerHTML='Reviews',b.appendChild(c),!a){const a=document.createElement('p');return a.innerHTML='No reviews yet!',void b.appendChild(a)}const d=document.getElementById('reviews-list');a.forEach((a)=>{d.appendChild(createReviewHTML(a))}),b.appendChild(d)},createReviewHTML=(a)=>{const b=document.createElement('li'),c=document.createElement('p');c.innerHTML=a.name,b.appendChild(c);const d=document.createElement('p');d.innerHTML=a.date,b.appendChild(d);const e=document.createElement('p');e.innerHTML=`Rating: ${a.rating}`,b.appendChild(e);const f=document.createElement('p');return f.innerHTML=a.comments,b.appendChild(f),b},fillBreadcrumb=(a=self.restaurant)=>{const b=document.getElementById('breadcrumb'),c=document.createElement('li');c.innerHTML=a.name,b.appendChild(c)},getParameterByName=(a,b)=>{b||(b=window.location.href),a=a.replace(/[\[\]]/g,'\\$&');const c=new RegExp(`[?&]${a}(=([^&#]*)|&|#|$)`),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g,' ')):'':null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwibGF6eUxvYWQiLCJMYXp5TG9hZCIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJjb25zb2xlIiwic2VsZiIsInpvb20iLCJjZW50ZXIiLCJmaWxsQnJlYWRjcnVtYiIsIkRCSGVscGVyIiwiY2FsbGJhY2siLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwiaWQiLCJuYW1lIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImFkZHJlc3MiLCJwaWN0dXJlIiwic291cmNlU21hbGwiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic2V0QXR0cmlidXRlIiwic291cmNlTGFyZ2UiLCJhcHBlbmQiLCJpbWFnZSIsIm9ubG9hZCIsImN1aXNpbmUiLCJjdWlzaW5lX3R5cGUiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiZGF5Iiwicm93IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwicmV2aWV3cyIsImNvbnRhaW5lciIsInRpdGxlIiwibm9SZXZpZXdzIiwiZm9yRWFjaCIsInJldmlldyIsInVsIiwiY3JlYXRlUmV2aWV3SFRNTCIsImxpIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsImdldFBhcmFtZXRlckJ5TmFtZSIsInVybCIsImhyZWYiLCJsb2NhdGlvbiIsInJlcGxhY2UiLCJyZXN1bHRzIiwiZGVjb2RlVVJJQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBLEFBQUlBLFlBQ0osR0FBQSxBQUFJQyxBQUVKLEtBSUFDLFNBQVcsSUFBTSxHQUFqQkEsQUFBaUIsQUFBSUMsQUFFckIsVUFHQUMsT0FBQUEsQUFBT0MsUUFBVSxJQUFNLEFBQ3JCQyx3QkFBdUIs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TCxTQUFBLEFBQXdCNkIsY0FBeEJBLEFBQUEsQUFDQUQsT0FBQUEsQUFBR1YsQUFBSCxxQkFBQSxFQUFBLE1BQUFVLEFBSUEsS0FBQSxBQUFHLEFBQVksQUFEZkUsb0JBQUFBLEdBQUEsU0FBQSxBQUFvQixjQUFwQkEsQUFBQSxBQUFxQ0EsQUFDckNGLEtBR0FHLEFBQ0FILFNBSkFBLEFBQUdWLFVBQUgsRUFBQVUsQUFBQSxBQUlBLFdBQUEsQUFBRyxBQUFZLEFBRGZHLGdCQWxCRixBQXFCRSxFQUdGLGVBQUEsQ0FBQSxFQUFBLEtBQUEsYUFBQSxBQUlFLE1BQU0sR0FBYSxTQUFBLEFBQVMsZUFBNUIsQUFBbUIsQUFBd0IsQUFDM0MsY0FBTSxFQUFLLFNBQUEsQUFBUyxjQUFwQixBQUFXLEFBQXVCLEFBRnBDeEMsUUFBQUEsVUFBaUIsRUFBakJBLEFBQWtCWixBQUNoQixPQUFBLEFBQU1xRCxBQUFhbEMsQUFDbkIsY0FMRixBQU9Fa0MsRUFHRixtQkFBQSxPQUFBLEFBSUUsQUFBSSxBQUFDLEtBQ0gsRUFBTSxPQUFBLEFBQU8sU0FBYixBQUFzQixBQUYxQkMsUUFBQUEsRUFBQUEsUUFBQUEsQUFBc0JwQyxVQUF0Qm9DLEFBQXFCLEFBQ25CLGFBQUtDLEdBQ0hBLEdBQUFBLEFBQU1uRCxRQUFnQm9ELEFBQXRCLE9BQWFDLENBRGYsQUFDRUYscUJBQ0ZyQyxFQUFZd0MsRUFGWixBQUVZQSxBQUFRLEFBQ3BCLGlCQUVLQyxFQUFMLEFBQUtBLEFBQUwsQUFFQSxHQUVPQyxtQkFBbUJELEVBQUFBLEFBQVEsR0FBUkEsQUFBV0QsUUFBWEMsQUFBbUIsTUFBN0MsQUFBT0MsQUFBbUJELEFBQTBCLEFBVnRELE1BUUUsQUFBS0EsQUFFTCxHQU5BLEFBQ0VBLEFBQ0YsQUFBSSxJQVROIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50O1xyXG52YXIgbWFwO1xyXG5cclxuLyoqXHJcbiAqIExhenlMb2FkaW5nIGltYWdlcyBvbiBpbml0XHJcbiAqL1xyXG5cclxubGF6eUxvYWQgPSAoKSA9PiBuZXcgTGF6eUxvYWQgKCk7XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xyXG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxuZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xyXG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXHJcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcclxuICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxyXG4gICAgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnO1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcclxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG5cclxuICAgIGNvbnN0IHBpY3R1cmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcclxuXHJcbiAgICBjb25zdCBzb3VyY2VTbWFsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gICAgc291cmNlU21hbGwuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICAgIHNvdXJjZVNtYWxsLnNldEF0dHJpYnV0ZShcImRhdGEtc3Jjc2V0XCIsREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpICsgXCJfc21hbGwud2VicFwiKTtcclxuICAgIHNvdXJjZVNtYWxsLnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIFwiKG1pbi13aWR0aDogNDAwcHgpXCIpXHJcbiAgICBwaWN0dXJlLmFwcGVuZChzb3VyY2VTbWFsbCk7XHJcblxyXG4gICAgY29uc3Qgc291cmNlTGFyZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZUxhcmdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBzb3VyY2VMYXJnZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNyY3NldFwiLERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArIFwiX2xhcmdlLndlYnBcIik7XHJcbiAgICBzb3VyY2VMYXJnZS5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBcIihtaW4td2lkdGg6IDkwMHB4KVwiKVxyXG4gICAgcGljdHVyZS5hcHBlbmQoc291cmNlTGFyZ2UpO1xyXG5cclxuICAgIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcgbGF6eSc7XHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNyY1wiLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyBcIl9zbWFsbC5qcGdcIik7XHJcbiAgICBpbWFnZS5hbHQgPSBcIkFuIGltYWdlIG9mIHJlc3RhdXJhbnQgXCIgKyByZXN0YXVyYW50Lm5hbWUgKyBcIiBpbiBcIiArIHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gICAgcGljdHVyZS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICAgIHBpY3R1cmUub25sb2FkID0gbGF6eUxvYWQoKTtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcclxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgZmlsbFJldmlld3NIVE1MKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xyXG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcclxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcclxuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XHJcblxyXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KTtcclxuXHJcbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcclxuXHJcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG5cclxuICBpZiAoIXJldmlld3MpIHtcclxuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcclxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XHJcbiAgfSk7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xyXG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xyXG5cclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XHJcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XHJcblxyXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xyXG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5maWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50PXNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICBpZiAoIXVybClcclxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcclxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcclxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XHJcbiAgaWYgKCFyZXN1bHRzKVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgaWYgKCFyZXN1bHRzWzJdKVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XHJcbn1cclxuIl19
