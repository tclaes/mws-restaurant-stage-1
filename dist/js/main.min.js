class DBHelper{static get DATABASE_URL(){return`http://localhost:${1337}/restaurants`}static fetchRestaurants(a){fetch(DBHelper.DATABASE_URL).then((a)=>a.json()).then((b)=>a(null,b))}static fetchRestaurantById(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const c=d.find((b)=>b.id===a);c?b(null,c):b('Restaurant does not exist',null)}})}static fetchRestaurantByCuisine(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const c=d.filter((b)=>b.cuisine_type==a);b(null,c)}})}static fetchRestaurantByNeighborhood(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const c=d.filter((b)=>b.neighborhood==a);b(null,c)}})}static fetchRestaurantByCuisineAndNeighborhood(a,b,c){DBHelper.fetchRestaurants((d,e)=>{if(d)c(d,null);else{let d=e;'all'!=a&&(d=d.filter((b)=>b.cuisine_type==a)),'all'!=b&&(d=d.filter((a)=>a.neighborhood==b)),c(null,d)}})}static fetchNeighborhoods(a){DBHelper.fetchRestaurants((b,c)=>{if(b)a(b,null);else{const b=c.map((a,b)=>c[b].neighborhood),d=b.filter((a,c)=>b.indexOf(a)==c);a(null,d)}})}static fetchCuisines(a){DBHelper.fetchRestaurants((b,c)=>{if(b)a(b,null);else{const b=c.map((a,b)=>c[b].cuisine_type),d=b.filter((a,c)=>b.indexOf(a)==c);a(null,d)}})}static urlForRestaurant(a){return`./restaurant.html?id=${a.id}`}static imageUrlForRestaurant(a){return`/images/${a.id}-small_small.jpg`}static imageWebpUrlForRestaurant(a){return`/images/${a.id}-small_small.webp 200w, /images/${a.id}-large_large.webp 900w`}static imageSrcsetForRestaurant(a){return`/images/${a.id}-small_small.jpg 200w, /images/${a.id}-large_large.jpg 900w`}static mapMarkerForRestaurant(a,b){const c=new google.maps.Marker({position:a.latlng,title:a.name,url:DBHelper.urlForRestaurant(a),map:b,animation:google.maps.Animation.DROP});return c}}let restaurants,neighborhoods,cuisines,map;var markers=[];function init(){new IntersectionObserver(()=>{},{root:null,rootMargin:'0px',threshold:[0]})}document.addEventListener('DOMContentLoaded',()=>{fetchNeighborhoods(),fetchCuisines(),init()}),fetchNeighborhoods=()=>{DBHelper.fetchNeighborhoods((a,b)=>{a?console.error(a):(self.neighborhoods=b,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=(a=self.neighborhoods)=>{const b=document.getElementById('neighborhoods-select');a.forEach((a)=>{const c=document.createElement('option');c.innerHTML=a,c.value=a,b.append(c)})},fetchCuisines=()=>{DBHelper.fetchCuisines((a,b)=>{a?console.error(a):(self.cuisines=b,fillCuisinesHTML())})},fillCuisinesHTML=(a=self.cuisines)=>{const b=document.getElementById('cuisines-select');a.forEach((a)=>{const c=document.createElement('option');c.innerHTML=a,c.value=a,b.append(c)})},window.initMap=()=>{self.map=new google.maps.Map(document.getElementById('map'),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),self.map.addListener('tilesloaded',setMapTitle),updateRestaurants()},setMapTitle=()=>{const a=document.querySelector('#map').querySelector('iframe');a.setAttribute('title','Google maps with restaurant location')},updateRestaurants=()=>{const a=document.getElementById('cuisines-select'),b=document.getElementById('neighborhoods-select'),c=a.selectedIndex,d=b.selectedIndex,e=a[c].value,f=b[d].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(e,f,(a,b)=>{a?console.error(a):(resetRestaurants(b),fillRestaurantsHTML())})},resetRestaurants=(a)=>{self.restaurants=[];const b=document.getElementById('restaurants-list');b.innerHTML='',self.markers.forEach((a)=>a.setMap(null)),self.markers=[],self.restaurants=a},fillRestaurantsHTML=(a=self.restaurants)=>{const b=document.getElementById('restaurants-list');a.forEach((a)=>{b.append(createRestaurantHTML(a))}),addMarkersToMap()},createRestaurantHTML=(a)=>{const b=document.createElement('li'),c=document.createElement('img');c.className='restaurant-img',c.srcset=DBHelper.imageUrlForRestaurant(a),c.alt='An image of restaurant '+a.name+' in '+a.neighborhood,b.append(c);const d=document.createElement('h2');d.innerHTML=a.name,b.append(d);const e=document.createElement('p');e.innerHTML=a.neighborhood,b.append(e);const f=document.createElement('p');f.innerHTML=a.address,b.append(f);const g=document.createElement('a');return g.innerHTML='View Details',g.href=DBHelper.urlForRestaurant(a),b.append(g),b},addMarkersToMap=(a=self.restaurants)=>{a.forEach((a)=>{const b=DBHelper.mapMarkerForRestaurant(a,self.map);google.maps.event.addListener(b,'click',()=>{window.location.href=b.url}),self.markers.push(b)})};